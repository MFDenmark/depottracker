<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FrihedOptimer</title>
<style>
:root{
  --blue:#2c6cff;
  --blue-dark:#1f4ed8;
  --bg:#f4f7fb;
  --card:#ffffff;
  --text:#0f172a;
  --muted:#64748b;
  --line:#e2e8f0;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
  background:var(--bg);
  color:var(--text);
}
.container{
  max-width:720px;
  margin:40px auto;
  padding:20px;
}
.brand{
  font-weight:700;
  font-size:14px;
  color:var(--muted);
  margin-bottom:20px;
}
.card{
  background:var(--card);
  border-radius:20px;
  padding:28px;
  box-shadow:0 20px 50px rgba(15,23,42,.08);
}
h1{
  margin:0 0 10px 0;
  font-size:30px;
}
.sub{
  color:var(--muted);
  margin-bottom:25px;
}
button{
  background:linear-gradient(135deg,var(--blue),var(--blue-dark));
  color:white;
  border:none;
  padding:14px 22px;
  font-size:16px;
  border-radius:12px;
  cursor:pointer;
}
button.secondary{
  background:none;
  color:var(--blue-dark);
  padding:10px 0;
}
.section{
  margin-top:30px;
}
label{
  font-size:12px;
  color:var(--muted);
  font-weight:600;
}
input{
  width:100%;
  padding:12px;
  margin:6px 0 16px 0;
  font-size:16px;
  border-radius:10px;
  border:1px solid var(--line);
}
.result{
  margin-top:40px;
  text-align:center;
}
.big{
  font-size:72px;
  font-weight:800;
  color:var(--blue);
  line-height:1;
}
.unit{
  font-size:16px;
  color:var(--muted);
  margin-bottom:10px;
}
.timeline{
  margin:30px 0;
  height:10px;
  background:#e5e7eb;
  border-radius:5px;
  position:relative;
}
.timeline .blue{
  position:absolute;
  top:0;
  right:0;
  height:10px;
  background:linear-gradient(135deg,var(--blue),var(--blue-dark));
  border-radius:5px;
}
.small{
  font-size:13px;
  color:var(--muted);
}
.details{
  margin-top:20px;
  text-align:left;
  font-size:14px;
  background:#f8fafc;
  padding:15px;
  border-radius:10px;
  display:none;
}
.disclaimer{
  font-size:12px;
  color:var(--muted);
  margin-top:20px;
}
</style>
</head>
<body>

<div class="container">
<div class="brand">FrihedOptimer</div>

<div class="card">

<h1>Hvornår kan du selv vælge at stoppe?</h1>
<div class="sub">Realmodel: 4% opsparing · 2% udbetaling · 10% sikkerhedsmargin</div>

<label>Alder</label>
<input type="number" id="age" value="37">

<label>Opsparing (kr.)</label>
<input type="number" id="savings" value="250000">

<label>Månedlig investering (kr.)</label>
<input type="number" id="monthly" value="1500">

<label>Ønsket månedlig indkomst (kr.)</label>
<input type="number" id="targetMonthly" value="20000">

<label>Udbetalingsperiode (år)</label>
<input type="number" id="payoutYears" value="20">

<div class="result">
<div class="big" id="yearsBack">0</div>
<div class="unit">år tidligere</div>

<div class="timeline">
<div class="blue" id="blueBar" style="width:0%"></div>
</div>

<div class="small" id="summary"></div>

<button class="secondary" onclick="toggleDetails()">Se beregningsdetaljer</button>

<div class="details" id="detailsBox"></div>

<div class="disclaimer">
Beregningen er vejledende og baseret på realafkast og konservativ sikkerhedsmargin.
</div>

</div>

</div>
</div>

<script>

const rAccum = 0.04;   // 4% real
const rPayout = 0.02;  // 2% real
const margin = 0.10;   // 10% safety

function pensionAge(age){
  const birth = 2026 - age;
  if (birth < 1963) return 67;
  if (birth < 1967) return 68;
  if (birth < 1971) return 69;
  if (birth < 1975) return 70;
  if (birth < 1979) return 71;
  return 72;
}

function capitalNeeded(monthly, years){
  const annual = monthly * 12;
  return annual * ((1 - Math.pow(1+rPayout, -years)) / rPayout);
}

function futureValue(age, stopAge, savings, monthly){
  const years = stopAge - age;
  const annual = monthly * 12;
  const fvSavings = savings * Math.pow(1+rAccum, years);
  const fvInvest = annual * ((Math.pow(1+rAccum, years)-1)/rAccum);
  return (fvSavings + fvInvest) * (1 - margin);
}

function calculate(){
  const age = parseFloat(document.getElementById("age").value);
  const savings = parseFloat(document.getElementById("savings").value);
  const monthly = parseFloat(document.getElementById("monthly").value);
  const targetMonthly = parseFloat(document.getElementById("targetMonthly").value);
  const payoutYears = parseFloat(document.getElementById("payoutYears").value);

  const official = pensionAge(age);
  const needed = capitalNeeded(targetMonthly, payoutYears);

  let freedom = official;

  for(let a=age; a<=official; a+=0.1){
    if(futureValue(age,a,savings,monthly) >= needed){
      freedom = a;
      break;
    }
  }

  const yearsBack = official - freedom;
  document.getElementById("yearsBack").innerText = yearsBack.toFixed(1).replace(".",",");

  const percent = (official - freedom) / (official - age) * 100;
  document.getElementById("blueBar").style.width = percent + "%";

  document.getElementById("summary").innerText =
    "Officiel pensionsalder: " + official + 
    " · Din mulighed: " + freedom.toFixed(1);

  document.getElementById("detailsBox").innerHTML =
    "<strong>Målkapital:</strong> " + Math.round(needed).toLocaleString("da-DK") + " kr.<br>" +
    "<strong>Forventet kapital ved stop:</strong> " +
    Math.round(futureValue(age,freedom,savings,monthly)).toLocaleString("da-DK") + " kr.<br>" +
    "<strong>Sikkerhedsmargin:</strong> 10% fratrukket kapital";
}

function toggleDetails(){
  const el = document.getElementById("detailsBox");
  el.style.display = el.style.display === "block" ? "none" : "block";
}

document.querySelectorAll("input").forEach(i=>{
  i.addEventListener("input",calculate);
});

calculate();

</script>

</body>
</html>
